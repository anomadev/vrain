En PHP, una función de usuario se declara con la palabra clave `function`, un nombre que sigue las mismas reglas que las etiquetas (letra o guion bajo seguido de letras, cifras o guiones bajos), una lista opcional de parámetros entre paréntesis y un bloque de código entre llaves [PHP](https://www.php.net/manual/en/functions.user-defined.php). A partir de PHP 8.0, la lista de parámetros puede terminar con una coma (`function foo($a, $b,) { … }`) [PHP](https://www.php.net/manual/en/functions.user-defined.php). Las funciones pueden definirse en cualquier lugar del script y PHP las procesa antes de la ejecución, lo que permite llamarlas incluso antes de su declaración, salvo cuando se crean condicionalmente dentro de bloques `if` [PHP](https://www.php.net/manual/en/functions.user-defined.php). No existe sobrecarga ni redefinición de funciones: cada nombre debe ser único y las definiciones son globales en todo el script [PHP](https://www.php.net/manual/en/functions.user-defined.php). También es posible definir funciones dentro de otras funciones, activándose únicamente cuando la función exterior se ejecuta [PHP](https://www.php.net/manual/en/functions.user-defined.php), y recurrir a la recursión, teniendo cuidado de no superar cientos de llamadas para evitar desbordar la pila [PHP](https://www.php.net/manual/en/functions.user-defined.php).
### Definición
Una función de usuario en PHP es un bloque de código reutilizable declarado así:
```php
function name($param1, $param2 = defaultValue /* , ...*/) {
	// cuerpo de la función
	return $value;
}
```
Donde:
- `name` debe cumplir el patrón `^[a-zA-Z_\x80-\xff][a-zA-Z0-9_\x80-\xff]*$` [PHP](https://www.php.net/manual/en/functions.user-defined.php)
- Los **parámetros** pueden tener **valores por defecto** y, desde PHP 8.0, la lista admite coma final
- El **cuerpo** acepta cualquier código PHP, incluidas otras definiciones de funciones o clases
### Conceptos clave
- **Declaración tardía**: PHP registra todas las funciones antes de ejecutar el script, permitiendo llamarlas antes de su definición, salvo en las declaraciones condicionales.
- **Funciones condicionales**: solo existen tras evaluarse la condición; si la condición no se cumple, no están disponibles.
- **Funciones dentro de funciones**: la función interna solo se registra al ejecutar la externa.
- **Alcance global**: todas las funciones (y clases) tienen alcance global; pueden llamarse en cualquier parte del script.
- **Sin sobrecarga ni redefinición**: no es posible definir dos funciones con el mismo nombre ni anularlas durante la ejecución.
- **Nombres insensibles a mayúsculas**: aunque PHP no distingue mayúsculas en nombres de función, es buena práctica respetar la declaración original.
- **Parámetros variables y por defecto**: soporta número variable de argumentos (`func_num_args`, `func_get_arg(s)`) y parámetros con valores por defecto.
- **Recursión**: funciones pueden llamarse a sí mismas, pero excesivos (100-200) pueden desbordar la pila.
### Ejemplos prácticos
##### Declaración básica
```php
<?php

function foo($a, $b = 2) {
	echo "a + b = " . ($a + $b);
	return $a + $b;
}

foo(3);    // 5
foo(3, 5); // 8

```
##### Parámetro final con coma (PHP 8.0+)
```php
<?php

function bar($x, $y,) {
	return $x * $y;
}

echo bar(4, 5); // 20

```
##### Función condicional
```php
<?php

$flag = true;

if ($flag) {
	function saludo() {
		echo "Hola!";
	}
}

// saludo() solo existe si $flag es true
saludo();

```
##### Función dentro de función 
```php
<?php

function externa() {
	function interna() {
		echo "Estoy dentro";
	}
}

// interna() no existe aún
externa();
interna(); // ahora sí

```
##### Recursión con límite
```php
<?php

function cuenta($n) {
	if ($n <= 0) return;
	echo $n-- . "\n";
	cuenta($n);
}

cuenta(5);
```
## Nota
---
- Usar parámetros con valores por defecto para simplificar llamadas comunes.
- Evitar definir funciones dentro de condiciones salvo casos muy específicos para no complicar la legibilidad.
- Vigilar la recursión profunda: usar bucles cuando la profundidad es alta.
