PHP proporciona múltiples extensiones y funciones dedicadas al procesamiento de XML que abarcan desde parsers basados en eventos (`XMLparsers`) hasta métodos orientados a objetos (`SimpleXML`, `DOM`, `XMLReader/XMLWriter`) ([[11.1 Classes and Objects]]). Cada enfoque está diseñado para distintos escenarios:
`SimpleXML` para lecturas y escrituras rápidas y sencillas; `DOM` para manipulaciones complejas del árbol de documentos; `XMLReader/XMLWriter` para flujos de gran volumen sin consumir excesiva memoria; y el parser `SAX` nativo para un control fino de eventos en streaming. Además PHP soporta `XML-RPC` para servicios remotos y utilidades de `diff`/`merge` con `XMLDiff`. 

---
### Definiciones Principales
- **`SimpleXML`** (`book.simplexml`): API orientada a objetos para cargar, recorrer y modificar documentos XML sin sintaxis verbosa.
- **DOM** (`DOMDocument`): Manipulación completa del árbol XML con métodos para crear, insertar, eliminar nodos y usar `XPath`.
- **`XMLReader` / `XMLWriter`** (`book.xmlreader`, `book.xmlwriter`): Lectura/escritura basada en streams, ideales para procesar documentos enormes línea a línea sin cargar todo en memoria.
- **`XML Parser (SAX)`** (`book.xml`): Parser basado en eventos (`callbacks` `xml_set_element_handler`) para control detallado de parsing.
- **`XML-RPC`** (`book.xmlrpc`): Soporte para llamadas de procedimiento remoto sobre XML, con funciones como `xmlrpc_decode` y `xmlrpc_encode`.
- **`XMLDiff`** (`book.xmldiff`): Clases para calcular y aplicar diferencias entre documentos XML.

---
### Conceptos Clave
1. **Procesamiento bajo memoria**
	- `SimpleXML` carga todo el documento en memoria; óptimo para archivos pequeños y acceso directo a nodos.
	- `XMLReader` lee un nodo a la vez streaming; ideal para XML de gran tamaño sin escalar memoria
2. **Manipulación del Árbol**
	- `DOMDocument` permite agregar, mover o eliminar nodos, aplicar validaciones y usar `XPath` para consultas avanzadas.
3. **Escritura Eficiente**
	- `XMLWriter` genera XML incrementalmente, controlado atributos, espacios de nombre y `DTDs` sin concatenar manualmente cadenas.
4. **Parsers Basados en Eventos**
	- El `XML Parser` nativo `SAX` gestiona `callbacks` ([[6.5 Anonymous Functions]]) para inicio/fin de elementos y datos de caracteres, útil donde se requiere máximo control.
5. **Integraciones y Servicios**
	- `XML-RPC` para exponer funciones ([[6.0 Functions]]) PHP como servicios remotos y consumir `endpoints XML-RPC`.
	- `XMLDiff` para comparar y fusionar documentos en aplicaciones de sincronización.

---
### Ejemplos Prácticos
##### Leer un feed RSS con `SimpleXML`
```php
<?php

$rss = simplexml_load_file('https://example.com/feed.xml');
foreach ($rss->channel->item as $item) {
	echo "[{$item->pubDate}] {$item->title}\n";
}

```
*Caso de uso*: Agregar posts recientes a un `dashboard`.
##### Validar y modificar XML con `DOMDocument`
```php
<?php

$dom = new DOMDocument;
$dom->loadXML($xmlString);

$xpath = new DOMXPath($dom);
$nodes = $xpath->query('//user[age<18]');

foreach ($nodes as $user) {
	$user->setAttribute('minor', 'true');
}
echo $dom->saveXML();

```
*Caso de uso*: Marcar usuarios menores en un reporte.
##### Procesar XML grande con `XMLReader`
```php
<?php

$reader = new XMLReader;
$reader->open('large.xml');

while ($reader->read()) {
	if ($reader->nodeType === XMLReader::ELEMENT && $reader->name === 'record') {
		$node = $reader->expand();
		// Procesar $node (DOMNode) sin cargar todo el documento
	}
}

$reader->close();

```
*Caso de uso*: Importar registros masivos de un sistema legado.
##### Genera XML con `XMLWriter`
```php
<?php

$writer = new XMLWriter;
$writer->openURI('output.xml');
$writer->startDocument('1.0', 'UTF-8');
$writer->startElement('products');

foreach ($products as $p) {
	$writer->startElement('product');
	$writer->writeAttribute('id', $p->id);
	$writer->writeElement('name', $p->name);
	$writer->writeElement('price', $p->price);
	$writer->endElement(); // product
}

$writer->endElement(); // products
$writer->endDocument();
$writer->flush();

```
*Caso de uso*: Exportar catálogo a sistema externo.
##### Parseo con `callbacks` (`SAX`)
```php
<?php

$parser = xml_parser_create();
xml_set_element_handler($parser, function($p, $name, $attrs) {
	echo "Start: $name\n";
}, function($p, $name) {
	echo "End: $name\n";
});

if (!($fp = fopen('data.xml', 'r'))) { die("No se abre") }

while ($data = fread($fp, 4096)) {
	xml_parse($parser, $data, feof($fp)) or 
		die(xml_error_string(xml_get_error_code($parser)));
}
xml_parser_free($parser);

```
*Caso de uso*: Auditoría de estructura de XML en logs.

---
## ✍️ Notas
- Para tareas rápidas de transformación usar `SimpleXML` junto con `json_encode(json_decode())` cuando la estructura es simple.
- Es importaciones masivas usar `XMLReader` para evitar picos de memoria y asegurar estabilidad.
