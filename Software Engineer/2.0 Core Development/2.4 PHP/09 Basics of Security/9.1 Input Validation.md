La extensión `Filter` de PHP proporciona un conjunto robusto de funciones para validar y sanitizar entradas de usuario, reduciendo riesgos de inyecciones (SQL [[9.2 SQL Injection]], XSS [[9.3 XSS Prevention]]) y datos corruptos. Con funciones clave como `filter_input()`, `filter_var()` y `filter_has_var()`, se pueden aplicar filtros de validación (`FILTER_VALIDATE_EMAIL`, `FILTER_VALIDATE_INT`, etc.) y filtros de saneamiento (`FILTER_SANITIZE_STRING`, `FILTER_SANITIZE_URL`, etc.) de forma concisa. Además, el uso de `flags` (`FILTER_FLAG_STRIP_LOW`, `FILTER_REQUIRE_ARRAY`) permite un control fino sobre el proceso de filtrado. Integrar estos filtros en formularios HTML y `APIs` garantiza que el `backend` reciba datos en el formato esperado simplificando enormemente la lógica de validación y mejorando la seguridad general de la aplicación.

---
### Definiciones Principales
- `filter_input(int $type, string $variable_name, int $filter = FILTER_DEFAULT, array|int $options = 0): mixed`: Obtiene y filtra una variable externa (p. ej. de `$_GET`, `$_POST`) en un solo paso.
- `filter_var(mixed $value, int $filter = FILTER_DEFAULT, array|int $options = 0): mixed`: Aplica un filtro a un valor dado (validación o saneamiento) sin depender de superglobals ([[8.2 Super Global Variables]]).
- `filter_has_var(int $type, string $variable_name): bool`: Verifica si existe la variable en el tipo indicado (`INPUT_GET`, `INPUT_POST`, etc.).
- Filtros de Validación (`FILTER_VALIDATE_*`): Comprueban que el dato cumple un patrón o formato, devolviendo el valor o `false` en fallo.
- Filtros de Saneamiento (`FILTER_SANITIZE_*`): Limpian el dato eliminado o codificando caracteres no deseados, devolviendo siempre una cadena.

---
### Conceptos Clave
1. **Tipos de Filtros**
	- **Validación**: Verifica formato sin modificar el valor original.
	- **Saneamiento**: Transformación del valor para hacerlo seguro (`strip tags`, remover, caracteres bajos).
2. **Contextos de Uso**
	- **Formularios HTML**: Captura y valida directamente con `filter_input(INPUT_POST, ...)`.
	- **`APIs REST`**: Decodificación JSON y luego usa `filter_var()` para sanitizar cada campo.
3. **Opciones y `Flags`**
	- `options`: Permiten valores por defecto o rangos en validación (`min_range`, `max_range`).
	- `flags`: Controlan comportamiento del filtro, p. ej. `FILTER_FLAG_STRIP_LOW` remueve caracteres ASCII de control.
4. **Manejo de `Arrays`**: con `FILTER_REQUIRE_ARRAY`, `filter_input()` procesa múltiples valores como array, útil en campos `name="tags[]"`.
5. **Flujo Recomendado**:
	1. **Detectar existencia**: `filter_has_var()` antes de filtrar.
	2. **Validar**: Usar `FILTER_VALIDATE_*` para chequear formato.
	3. **Saneamiento adicional**: `htmlspecialchars()` al mostrar en HTML.

---
### Ejemplos Prácticos
##### Validar email en un formulario
```php
<?php

if (!filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL)) {
	echo "Email inválido.";
} else {
	echo "Email válido: " . filter_input(INPUT_POST, 'email', FILTER_SANITIZE_EMAIL);
}
```
Un paso para validar y otro para sanitizar ([Tutorials Point](https://www.tutorialspoint.com/filter-input-function-in-php?utm_source=chatgpt.com) [W3Schools](https://www.w3schools.com/php/func_filter_input.asp?utm_source=chatgpt.com)).
##### Sanitizar URL antes de usarla
```php
<?php

$raw = $_GET['site'] ?? '';
$url = filter_var($raw, FILTER_SANITIZE_URL);
if (filter_var($url, FILTER_VALIDATE_URL)) {
	echo "URL válida: $url";
}
```
Elimina espacios de y caracteres peligrosos antes de validar.
##### Validar entero con rango
```php
<?php

$age = filter_input(INPUT_POST, 'age', FILTER_VALIDATE_INT, [
	'options' => ['min_range' => 18, 'max_range' => 120]
]);

if ($age === false) {
	echo "Edad debe ser entre 18 y 120.";
}
```
Evita lógica manual de rangos.
##### Filtrar lista de `tags`
```php
<?php

$tags = filter_input(INPUT_GET, 'tags', FILTER_SANITIZE_STRING, FILTER_REQUIRE_ARRAY);

foreach ($tags as $tag) {
	echo htmlspecialchars($tag) . '<br>';
}
```
Procesa `?tags[]=php&tags[]=security` como un array limpiado.
##### Usar `callback` personalizado
```php
<?php

function uppercase($val) { return strtoupper($val); }
$name = filter_input(INPUT_POST, 'name', FILTER_CALLBACK, ['options' => 'uppercase']);
echo $name; // imprime mayúsculas.
```

---
## ✍️ Notas

- Usar `filter_input()` en formularios y `filter_var()` en datos decodificados (JSON, CLI) por su legibilidad.
- Combinar filtros con validaciones adicionales (`regex` lógica del negocio) solo cuando los filtros nativos no cubre casos complejos.
