> [!info] Configuration Files (Roadmap SH)
> Los archivos de configuración son fundamentales para las aplicaciones PHP porque ayudan a administrar configuraciones dinámicas como información de conexión de base de datos, informes de errores y muchas otras configuraciones PHP sin codificación rígida, lo que hace que su aplicación sea flexible y segura. PHP utiliza un archivo `php.ini` para guardar esta configuración. Puede modificarla accediendo a este archivo y modificando sus valores. Por ejemplo, para ajustar el tamaño máximo de carga de archivos, puede modificar la directiva `upload_max_size`. Sin embargo, los cambios en el archivo `php.ini` solo surten efecto después de reiniciar el servidor.

### Definición
El uso de archivos de configuración en PHP se refiere a la práctica almacenar los parámetros de una aplicación (como credenciales de bases de datos, claves API o ajustes de comportamiento) en archivos externos en lugar de escribirlos directamente en el código. Esto permite una clara separación entre el código y la configuración.
PHP tiene soporte nativo para leer archivos con el formato `INI`, que es simple y legible para los humanos, a través de la función `parse_ini_file()`.

**Analogía**: Si tu aplicación es un personaje de un videojuego, el código son sus habilidades y comportamientos fijos. Los archivos de configuración son su inventario y equipo. No "sueldas" la espada a las manos del personaje; la equipas desde el inventario. De esta manera, puede cambiales la espada por un hacha (`configuración de la base de datos`) o cambiarle el casco por uno nuevo (`clave de API`) sin tener que "reprogramar" al personaje.

### Conceptos Clave
- Separación de Código y Configuración: Al igual que con las variables de entorno, este el principio rector. Permite que la misma aplicación se despliegue en diferentes entornos con diferentes configuraciones sin cambiar el código fuente.
- Formato `INI`: Un formato de archivo de texto simple y estándar.
	- Consiste en pares `clave = valor`
	- Las líneas que comienzan con punto y coma (`;`) son comentarios
	- Se pueden agrupar claves bajo `[secciones]`
- La función `parse_ini_file()`: Es la herramienta nativa de PHP para leer estos archivos.
	- `parse_ini_file(string $filename, bool $process_sections = false)`: Lee el archivo `INI` y lo convierte en un array asociativo PHP.
	- `$process_sections`: Este es el parámetro más importante. Si se establece en `true`, la función devuelve un array multidimensional donde las claves de primer nivel son los nombres de las secciones del archivo `INI`.
- Seguridad: Los archivos de configuración que contienen secretos (contraseñas, tokens) NUNCA deben estar en un directorio accesible desde la web. Deben almacenarse fuera de "`document root`".
- Alternativas a `INI`: Si bien `INI` tiene soporte nativo, otros formatos son muy populares y se usan a través de librerías:
	- `PHP Arrays`: Archivos `.php` que simplemente devuelven un array. Son rápidos porque se benefician de `OPcache`.
	- `YAML`: Muy legible para los humanos, popular en frameworks como Symfony.
	- `JSON`: Fácil de leer para máquinas y humanos, interoperable con JavaScript.

### Ejemplos Prácticos
##### El archivo de configuración (`config.ini`)
Un ejemplo de archivo `INI` que una aplicación podría usar.
```ini, toml
; Main Application Settings
app_name = "My Awesome App"
app_env = "production"

; Database Connection
[database]
host = "localhost"
user = "prod_user"
password = "p4ssw0rd_s3cr3t"
dbname = "production_db"

; API Keys
[api_keys]
stripe_key = "pk_live_123abc..."
mailer_key = "key-456def..."
```
##### Leer el archivo `INI` con PHP
Veamos cómo `parse_ini_file()` interpreta el archivo de dos manera diferentes.
**A) Sin procesar secciones (comportamiento por defecto)**:
```php
<?php
// Reads the INI file but ignores the [sections]
// Section keys are parsed with a dot notation, which can cause issues.
$config = parse_ini_file('config.ini');

print_r($config);

/*
Output:
Array
(
    [app_name] => My Awesome App
    [app_env] => production
    [host] => localhost
    [user] => prod_user
    [password] => p4ssw0rd_s3cr3t
    [dbname] => production_db
    [stripe_key] => pk_live_123abc...
    [mailer_key] => key-456def...
)
*/
```
**B) Procesando secciones (la forma recomendada)**:
```php
<?php
// Reads the INI file and creates a multi-dimensional array
$config = parse_ini_file('config.ini', true);

print_r($config);
echo "Database Host: " . $config['database']['host'] . "\n";
echo "Stripe Key: " . $config['api_keys']['stripe_key'] . "\n";

/*
Output:
Array
(
    [app_name] => My Awesome App
    [app_env] => production
    [database] => Array
        (
            [host] => localhost
            [user] => prod_user
            [password] => p4ssw0rd_s3cr3t
            [dbname] => production_db
        )

    [api_keys] => Array
        (
            [stripe_key] => pk_live_123abc...
            [mailer_key] => key-456def...
        )
)
Database Host: localhost
Stripe Key: pk_live_123abc...
*/
```
