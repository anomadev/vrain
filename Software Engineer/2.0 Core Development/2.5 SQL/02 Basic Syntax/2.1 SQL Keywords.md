Los `keywords` en SQL son palabras reservadas que definen sentencias, operadores y funciones fundamentales para interactuar con la base de datos. Cada `keyword` tiene una función específica: desde crear estructuras (tablas, índices) hasta manipular datos (insertar, actualizar, eliminar) y consultar información (seleccionar, agrupar, ordenar).

---
### Conceptos Clave
1. **Categorías de `keywords`**
	- DDL (`Data Definition Language`): Definen o modifican estructuras de la base de datos.
		- `CREATE`, `ALTER`, `DROP`, `TRUNCATE`, `RENAME`
	- DML (`Data Manipulation Language`): Manipulan los datos guardados en las tablas.
		- `SELECT`, `INSERT`, `UPDATE`, `DELETE`, `MERGE`
	- DCL (`Data Control Language`): Gestionan permisos y seguridad
		- GRANT, REVOKE
	- TCL (`Transation Control Language`): Controlan transacciones
		- `BEGIN` (o `START TRANSACTION`), `COMMIT`, `ROLLBACK`, `SAVEPOINT`
2. **Consultas y Filtrado**
	- `SELECT`: Extrae datos de las tablas
	- `FROM`: Especifica la tabla origen
	- `WHERE`: Filtra filas según condiciones
	- `JOIN` (o variantes: `INNER JOIN`, `LEFT JOIN`, `RIGHT JOIN`, `FULL JOIN`): Combina filas de dos o más
	- `GROUP BY`: Agrupa filas según uno o varios campos
	- `HAVING`: Filtra grupos ordenados por `GROUP BY`
	- `ORDER BY`: Ordena el resultado según uno o varios campos (ascendente o descendente)
	- `LIMIT` (MySQL, PostgreSQL) / `FETCH FIRST` (SQL Server, Oracle): Limita el número de filas devueltas.
3. **Operadores de Comparación Lógicos**
	- Comparación: `=`, `<>`, o `!=`, `<`, `>`, `<=`, `>=`
	- Rango: `BETWEEN ... AND ...` (inclusivo)
	- Conjunto: `IN (lista valores)` / `NOT IN (lista)`
	- Patrón: `LIKE`, `NOT LIKE` (uso de `%` y `_`)
	- Nulos: `IS NULL`, `IS NOT NULL`
	- Lógicos: `AND`, `OR`, `NOT`
4. **Funciones de Agregación**
	- `COUNT()`, `SUM()`, `AVG()`, `MIN()`, `MAX()`
	- Estas funciones operan sobre grupos definidos con `GROUP BY`
5. **Otras Sentencias Comunes**
	- `UNION` / `UNION ALL`: Combina resultados de dos consultas con la misma estructura de columnas.
	- `EXISTS` / `NOT EXISTS`: Verifica la existencia de fila en una subconsulta
	- `CASE WHEN ... THEN ... ELSE ... END`: Expresión condicional en `SELECT` o en cláusulas `DML`
6. **Definición de Índices y Vistas**
	- `CREATE INDEX` / `DROP INDEX`: Crea o elimina índices para acelerar consultas
	- `CREATE VIEW` / `DROP VIEW`: Define o elimina vistas ("tablas virtuales")

---
### Ejemplos Prácticos
##### DDL: Crear y modificar tablas
```sql
--- Crear tabla de departamentos
CREATE TABLE departamentos (
  dept_id    SERIAL PRIMARY KEY,
  nombre     VARCHAR(50) NOT NULL UNIQUE
);


--- Crear tabla de empleados, relacionándolos con departamentos
CREATE TABLE empleados (
  emp_id     SERIAL PRIMARY KEY,
  nombre     VARCHAR(100) NOT NULL,
  salario    DECIMAL(10,2),
  dept_id    INT,
  CONSTRAINT fk_departamento
    FOREIGN KEY (dept_id)
    REFERENCES departamentos(dept_id)
    ON DELETE SET NULL
);


--- Insertar departamentos de ejemplo
INSERT INTO departamentos (nombre)
VALUES ('Ventas'), ('Recursos Humanos'), ('Tecnología');

--- Agregar una nueva columna para la fecha de contratación
ALTER TABLE empleados
ADD COLUMN fecha_contratacion DATE DEFAULT CURRENT_DATE;
```
1. `CREATE TABLE` define dos tablas: `departamentos` y `empleados`
2. `SERIAL PRIMARY KEY` crea un campo auto-incremental
3. `FOREIGN KEY` establece la relación entre empleados y departamentos
4. `ALTER TABLE ... ADD COLUMN` inserta una nueva columna en `empleados`
##### DML: Insertar, actualizar y eliminar datos
`Escenario`: Registrar nuevos empleados y ajustar salarios.
```sql
--- Insertar empleados nuevos
INSERT INTO empleados (nombre, salario, dept_id)
VALUES 
  ('Ana Pérez', 25000.00, 3),
  ('Luis Gómez', 18000.50, 1),
  ('María López', 22000.75, 2);

--- Actualizar salario de un empleado
UPDATE empleados
SET salario = salario * 1.10  -- aumento del 10%
WHERE nombre = 'Ana Pérez';

--- Eliminar un empleado que ha renunciado
DELETE FROM empleados
WHERE emp_id = 2;  -- elimina a Luis Gómez si su emp_id=2
```
1. `INSERT` introduce filas nuevas en `empleados`
2. `UPDATE` modifica el salario de "Ana Perez" aplicando un 10% de aumento
3. `DELETE` borra el registro cuyo `emp_id` sea 2
##### SELECT y filtrado de datos
`Escenario`: Obtener listado de empleados filtrado, ordenado y con agregación
```sql
--- Listar todos los empleados del departamento de Tecnología
--- ordenados por salario descendiente
SELECT emp_id, nombre, salario
FROM empleados
WHERE dept_id = 3
ORDER BY salario DESC;

--- Contar cuántos empleado hay por departamento
SELECT d.nombre AS departamento, COUNT(e.emp_id) AS total_empleados
FROM departamentos d
LEFT JOIN empleados e ON d.dept_id = e.dept_id
GROUP BY d.nombre
HAVING COUNT(e.emp_id) > 0;  -- solo mostrar departamentos con al menos 1 empleado

--- Buscar empleados cuyo nombre contenga "Perez"
SELECT emp_id, nombre
FROM empleados
WHERE nombre LIKE '%Pérez%';
```
1. Filtra con `WHERE dept_id = 3`, ordena con `ORDER BY salario DESC`
2. Usa `LEFT JOIN` para incluir todos los departamentos, incluso con 0 empleados; luego `GROUP BY` y `COUNT` agrupan y cuentan. Filtra grupos con `HAVING`.
3. Emplea `LIKE %Perez%` para buscar coincidencias parciales en el nombre.
##### TCL: Control de transacciones
`Escenario`: Trasladar presupuesto entre departamentos: monto descontado de uno y acreditado a otro
```sql
--- Iniciar Transacción
BEGIN;

--- Restar $5000 a Recursos Humanos (dept_id = 2)
UPDATE departamentos
SET presupuesto = presupuesto - 5000
WHERE dept_id = 2;

--- Sumar $5000 a Tecnología (dept_id = 3)
UPDATE departamentos
SET presupuesto = presupuesto + 5000
WHERE dept_id = 3;

--- Confirmar si todo salió bien
COMMIT;

--- Sí algo falla antes de COMMIT, ejecutar
--- ROLLBACK; --- Revierte los cambios parciales
```
1. `BEGIN` inicia el bloque transaccional
2. Dos `UPDATE` que deben ejecutarse juntos
3. `COMMIT` confirma los cambios; si hubiera error, usar `ROLLBACK` para revertir
##### DCL: Gestión de permisos
`Escenario` Dar acceso de solo lectura a un analista y revocar permisos
```sql
--- Conceder permiso de SELECT en la tabla empleados al usuario analista
GRANT SELECT ON empleados TO analista;

--- Revocar permiso de SELECT cuando ya no sea necesario
REVOKE SELECT ON empleados FROM analista;
```
1. `GRANT SELECT` permite al usuario `analista` consultar la tabla `empleados`
2. `REVOKE SELECT` quita ese permiso

