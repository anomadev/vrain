La sentencia `DROP TABLE` en SQL es una instrucción DDL que elimina por completo una tabla de la base de datos, borrando tanto su estructura (columnas, índices, restricciones) como todos los datos almacenados en ellas. Una vez ejecutada, la tabla deja de existir, para recuperarla se necesita restaurar una copia de seguridad o volver a crearla manualmente.

---
### Conceptos Clave
##### Sintaxis básica
```sql
DROP TABLE nombre_tabla;
```
- Elimina la tabla especificada y sus datos sin posibilidad de recuperación inmediata.
- En muchos motores, no se puede ejecutar dentro de una transacción que pueda revertirse; ejecuta un `COMMIT` implícito.
##### `IF EXISTS`
Para evitar errores si la tabla no existe, se puede usar:
```sql
DROP TABLE IF EXISTS nombre_tabla;
```
De este modo, si la tabla no está presente, la instrucción se ignora en lugar de lanzar un error.
##### Impacto en claves foráneas
Si otra tabla tiene una clave foránea referenciando la tabla que se va a eliminar, el motor arrojará un error a menos que se elimine o modifique primera la restricción de la llave foránea.
Primero eliminar las `constraints` en las tablas dependientes:
```sql
ALTER TABLE tabla_dep DROP CONSTRAINT fk_nombre;
DROP TABLE tabla_principal;
```
O usar `DROP TABLE ... CASCADE` (en motores que lo soportan, como PostgreSQL) para forzar la eliminación de dependencias en cascada:
```sql
DROP TABLE nombre_tabla CASCADE;
```
En MySQL, no existe `CASCADE` en `DROP TABLE`; hay que eliminar las `constraints` manualmente.
##### Permisos requeridos
- Se necesita el privilegio `DROP` o un permiso de administrador para poder eliminar una tabla
- No basta con privilegios de `DELETE` o `ALTER` en general
##### Diferencia con `TRUNCATE TABLE`
- `TRUNCATE TABLE`: Vacía todas las filas de la tabla, pero conserva la estructura. Reinicia contadores de autoincremento.
- `DROP TABLE`: Elimina la tabla entera, incluida su definición. Para volver, a usarla, hay que crearla.
##### Efecto de índices y vistas
- Al eliminar la tabla, todos los índices, `triggers`, y vistas que dependen de ella se invalidan o eliminan según el motor.
- Conviene revisar dependencias de vistas y funciones antes de lanzar `DROP TABLE`.

---
### Ejemplos Prácticos
##### Eliminar una tabla simple
`Escenario`: tienes una tabla temporal `datos_prueba` que ya no necesitas y deseas borrarla completamente
```sql
-- Verificar si la tabla existe y eliminarla si existe:
DROP TABLE IF EXISTS datos_prueba;
```
- Si `datos_prueba` existe, se elimina sin error, si no, no pasa nada
- Borra estructura, datos e índices relacionados
##### Eliminar una tabla con claves foráneas
`Escenario`: Tienes dos tablas, `clientes` y `ordenes`. `ordenes` tiene una clave foránea a `clientes`. Para borrar `clientes`, primero debes eliminar FK en `ordenes`.
```sql
-- 1. Crear tablas de ejemplo
CREATE TABLE clientes (
  cliente_id SERIAL PRIMARY KEY,
  nombre     VARCHAR(100)
);

CREATE TABLE ordenes (
  orden_id    SERIAL PRIMARY KEY,
  cliente_id  INT NOT NULL,
  producto    VARCHAR(100),
  FOREIGN KEY (cliente_id) REFERENCES clientes(cliente_id)
);

-- 2. Si intentas eliminar clientes directamente:
-- DROP TABLE clientes;
-- ERROR: no puedes eliminar porque existe dependencia en ordenes.

-- 3. Quitar la constraint en ordenes:
ALTER TABLE ordenes
  DROP CONSTRAINT ordenes_cliente_id_fkey;  -- El nombre exacto depende del motor

-- 4. Ahora sí, eliminar clientes:
DROP TABLE clientes;

-- 5. Si quisieras eliminar ambas en cascada (PostgreSQL):
-- DROP TABLE clientes CASCADE;
-- Esto elimina clientes y todas las dependencias (incluida ordenes).

-- 6. Finalmente, eliminar ordenes si no se hizo CASCADE:
DROP TABLE IF EXISTS ordenes;
```
1. Define `clientes` y `ordenes`, donde `ordenes(cliente_id)` referencia `clientes(cliente_id)`
2. Al intentar `DROP TABLE clientes`, el motor bloquea porque `ordenes` depende de ella.
3. Eliminando la restricción en `ordenes`, ya puedes borrar `clientes`
4. En PostgreSQL, `DROP TABLE clientes CASCADE` haría ambos pasos de forma automática.
##### Uso en scripts de migración
`Escenario`: En un despliegue automatizado, quieres asegurarte de que la tabla `logs_temporales` se elimine antes de crearla de nuevo (para restablecer índices o cambiar estructura).
```sql
-- Script de despliegue
DROP TABLE IF EXISTS logs_temporales;

CREATE TABLE logs_temporales (
  log_id    SERIAL PRIMARY KEY,
  mensaje   TEXT NOT NULL,
  creado_en TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```
1. Elimina la tabla si existe (sin error si no)
2. Crea `logs_temporales` con la definición actualizada
3. Esto garantiza que cualquier cambio de columna o `constraint` anterior se aplique desde cero.
