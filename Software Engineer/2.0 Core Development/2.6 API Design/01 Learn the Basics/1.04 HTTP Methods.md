> [!info] HTTP Methods (Roadmap SH)
> Los métodos HTTP (Protocolo de Transferencia de Hipertexto) desempañan un papel fundamental en el diseño de API. Definen el tipo de solicitud que un cliente puede realizar a un servidor, proporcionando el marco para la interacción entre ambos. Comprender los métodos HTTP es fundamentar para crear una API robusta y eficaz. Algunos de los métodos HTTP más comunes en el diseño de API incluyen `GET`, `POST`, `PUT`, `DELETE` y `PATCH`. Cada uno de estos métodos representa un tipo diferente de solicitud, lo que permite diversas interacciones con los puntos finales de la API. Esto, a su vez, crea una API más dinámica, funcional y fácil de usar.
### Definición
Los métodos HTTP, a menudo llamados "verbos HTTP", son el componente de una solicitud HTTP que indica la acción deseada que se debe realizar sobre un recurso específico. Un recurso es identificado por una URI (`Uniform Resource Identifier`). Mientras que la URI le dice al servidor sobre qué actuar, el método le dice qué hacer con ese recurso. El uso correcto y semántico de estos métodos es una piedra angular del diseño de APIs RESTful.
### Conceptos Clave
- **Métodos Seguros (`Safe`)**: Son métodos que no tienen la intención de alterar el estado del servidor. Son operaciones de solo lectura. Los clientes, cachés y `proxies` pueden tratar las solicitudes con métodos seguros sin preocuparse por causar efectos secundarios. Los métodos seguros son: `GET`, `HEAD`, `OPTIONS`.
- **Métodos Idempotentes (`Idempotent`)**: Son métodos donde realizar una solicitud idéntica una o varias veces produce el mismo resultado y estado en el servidor que si se hubiera realizado una sola vez. Esto es crucial para manejar reintentos de red de forma segura. Los métodos idempotentes son: `GET`, `PUT`, `DELETE`, `HEAD`, `OPTIONS`. `POST` no es idempotente , la idempotencia de `PATCH` depende de su implementación.

|Método|Descripción|¿Seguro?|¿Idempotente?|Uso Típico en APIs (CRUD)|
|:--|:--|:--|:--|:--|
|**GET**|Recupera una representación de un recurso específico.|**Sí**|**Sí**|**Leer (Read)** - Obtener un usuario o una lista de usuarios.|
|**POST**|Envía una entidad a un recurso específico, a menudo causando un cambio de estado o la creación de un nuevo recurso.|No|No|**Crear (Create)** - Registrar un nuevo usuario.|
|**PUT**|Reemplaza **toda** la representación actual del recurso con los datos de la solicitud. Si el recurso no existe, puede crearlo.|No|**Sí**|**Actualizar/Reemplazar (Update)** - Actualizar completamente el perfil de un usuario.|
|**PATCH**|Aplica modificaciones **parciales** a un recurso.|No|No (generalmente)|**Actualizar/Modificar (Update)** - Cambiar solo el email de un usuario.|
|**DELETE**|Elimina un recurso específico.|No|**Sí**|**Borrar (Delete)** - Eliminar una cuenta de usuario.|

**Otros Métodos Útiles**
- `HEAD`: Idéntico a `GET`, pero el servidor no envía el cuerpo de la respuesta. Es útil para obtener los metadatos de un recurso (como el `Content-Type` o `Content-Length` en las cabeceras) sin tener que descargar todo el contenido. Es seguro e idempotente.
- `OPTIONS`: Describe las opciones de comunicación (los métodos HTTP permitidos) para el recurso de destino. Es usado por los navegadores para las solicitudes "`pre-flight`" de CORS (`Cross-Origin Resource Sharing`). Es seguro e idempotente.
### Ejemplos Prácticos
Imaginemos un API para gestionar una colección de usuarios (`/api/users`).
##### Obtener todos los usuarios (`Read - Collection`):
- Método: `GET`
- Endpoint: `/api/users`
- Resultado: Devuelve una lista de todos los usuarios.
```http
GET /api/users HTTP/1.1
Host: example.com
```
##### Crear un nuevo usuario (`Create`):
- Método: `POST`
- Endpoint: `/api/users`
- Resultado: Crea un nuevo usuario con los datos enviados en el cuerpo y generalmente devuelve el nuevo recurso creado, incluyendo su ID.
```http
POST /api/users HTTP/1.1
Host: example.com
Content-Type: application/json

{ "name": "Sam Wilson", "role": "Captain America" }
```
##### Obtener un usuario específico (`Read - Individual`):
- Métodos: `GET`
- Endpoint: `/api/users/123` (donde 123 es el ID del usuario)
- Resultado: Devuelve los detalles del usuario con ID 123
```http
GET /api/users/123 HTTP/1.1
Host: example.com
```
##### Actualizar completamente un usuario (`Update - Full`):
- Método: `PUT`
- Endpoint: `/api/users/123`
- Resultado: Reemplaza todos los datos del usuario 123. Si se omite el campo `role`, se eliminaría el recurso.
```http
PUT /api/users/123 HTTP/1.1
Host: example.com
Content-Type: application/json

{ "name": "Samuel Thomas Wilson", "role": "Captain America" }
```
##### Actualizar parcialmente un usuario (`Update - Partial`):
- Método: `PATCH`
- Endpoint: `/api/users/123`
- Resultado: Actualiza solo el campo `role`, el `name` no se ve afectado.
```http
PATCH /api/users/123 HTTP/1.1
Host: example.com
Content-Type: application/json

{ "role": "Team Leader" }
```
##### Eliminar un usuario (`Delete`):
- Método: `DELETE`
- Endpoint: `/api/users/123`
- Resultado: Elimina el usuario con ID 123 del sistema
```http
DELETE /api/users/123 HTTP/1.1
Host: example.com
```
### Notas
- **La semántica es la clave de REST**: La verdadera potencia de los métodos HTTP se revela en las APIs RESTful. Usar el verbo correcto para la acción correcta hace que tu API sea predecible, intuitiva y fácil de usar para otros desarrolladores. Evita el anti-patrón de usar `POST` para todo.
- **Idempotencia es tu mejor amigo para la resiliencia**: Cuando un cliente de API reintenta una operación `PUT` o `DELETE` debido a un fallo de red, puede hacerlo con la confianza de que no creará duplicados ni causará errores inesperados. Diseñar operaciones de actualización con `PUT` (idempotente) en lugar de `POST` (no idempotente) puede simplificar enormemente la lógica de reintentos del cliente.
