## Definición 
Top-P, también conocido como `Nucleus Sampling`, es un técnica que selecciona el subconjunto más pequeño de tokens cuya probabilidad acumulada suma al menos un umbral $P$ (donde $0 \leq P \leq 1$). Matemáticamente, si ordenamos los tokens por probabilidad descendente $p_1, p_2, ..., p_n$, el modelo solo considerará el conjunto de tokens hasta el índice $i$ tal que:
$$\sum_{j=1}^{i} p_j \geq P$$
### Conceptos Clave
- **Vocabulario Dinámico**: A diferencia de `Top-K` ([[5.2.3 Top-K]]), el número de palabras candidatas cambia en cada paso. Si el modelo está muy seguro, el "nucleo" será pequeño; si está confundido, el núcleo se expandirá.
- **Masa de Probabilidad**: El foco está en la confianza acumulada. Un $P=0.9$ significa que descartamos el 10% de las opciones más improbables (la "cola" de la distribución).
- **Relación con Top-K**: Top-P suele considerarse más avanzado porque permite que el modelo sea creativo cuando hay muchas opciones razonables y muy preciso cuando solo hay una respuesta lógica clara.
- **Efecto en el Output**: Previene alucinaciones raras al eliminar opciones que, aunque sean pocas, sumen ruido a la generación.

## Escenarios de Aplicación e Identificación
**Dónde aplicarlo?**
- **Chatbots de Propósito General**: Es el estándar para mantener conversaciones fluidas. Un $P$ entre 0.9 y 0.95 permite variedad sin perder la coherencia.
- **Traducción de idioma**: Ayuda a elegir entre sinónimos que tienen sentido gramatical (masa de probabilidad compartida) sin caer en palabras absurdas.
- **Resumen de Textos**: Permite que el modelo elija las palabras más representativas del contenido original basándose en la densidad de probabilidad del contexto.
**Cómo identificarlo?**
- **Fluidez Natural**: Si las respuestas se sienten menos "robóticas" o repetitivas que con un `Top-K` bajo, es probable que `Top-P` esté haciendo su trabajo.
- **Control de "Verbose"**: Si el modelo empieza a divagar con términos técnicos poco comunes fuera de lugar, el valor de $P$ podría estar demasiado carca de 1.0.

## Notas Personales
Desde la arquitectura de software es tu "Válvula de Confianza". Mientras que `Top-K` es como limitar una búsqueda a los 10 mejores resultados de Google, `Top-P` es como decirle al sistema: "Dame todos los resultados que sumen el 90% de la relevancia". Esto lo hace mucho más robusto para manejar diferentes tipos de prompts.